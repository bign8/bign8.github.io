angular.module("myApp",["ngRoute","myApp.controllers","myApp.filters","security","myApp.services","myApp.directives","templates-main"]).config(["$routeProvider","securityAuthorizationProvider","$locationProvider",function(a,b,c){c.html5Mode(!0),a.when("/payment",{templateUrl:"partials/custom-payment-form.tpl.html",controller:"CustPayFormCtrl"}).when("/register",{templateUrl:"partials/register-form.tpl.html",controller:"RegisterFormCtrl",resolve:{firms:["interface",function(a){return a.user("listFirms")}]}}).when("/",{templateUrl:"partials/index.tpl.html",controller:"IndexCtrl",resolve:{fullCart:["theCart",function(a){return a.load()}]}}).when("/register/:itemID",{templateUrl:"partials/register-conf.tpl.html",controller:"RegisterConFormCtrl",resolve:{conference:["interface","$route",function(a,b){return a.cart("getOption",b.current.params)}],user:b.requireAuthenticatedUser}}).when("/cart",{templateUrl:"partials/show-cart.tpl.html",controller:"CartCtrl",resolve:{preLoad:["theCart",function(a){return a.load()}],discounts:["interface",function(a){return a.cart("getDiscount")}],user:b.requireAuthenticatedUser}}).when("/recipt",{templateUrl:"partials/recipt-print.tpl.html",controller:"ReciptCtrl",resolve:{user:b.requireAuthenticatedUser}}).when("/purchases",{templateUrl:"partials/list-purchases.tpl.html",controller:"ListPurchasesCtrl",resolve:{user:b.requireAuthenticatedUser,items:["interface",function(a){return a.cart("getPurchases")}]}}).when("/user",{templateUrl:"partials/user-form.tpl.html",controller:"UserFormCtrl",resolve:{firms:["interface",function(a){return a.user("listFirms")}],user:["interface",function(a){return a.user("getFullUser")}]}}).otherwise({redirectTo:"/"})}]).run(["security","theCart",function(a,b){a.requestCurrentUser(),b.load()}]),angular.module("myApp.controllers",["myApp.services","ui.bootstrap"]).controller("IndexCtrl",["$scope","myPage","theCart","security",function(a,b,c,d){b.setTitle("Upstream Academy","Guiding accounting firms to high performance"),a.$watch(function(){return d.currentUser},function(){null!==d.currentUser&&d.redirect("/cart")},!0),a.theCart=c}]).controller("RegisterConFormCtrl",["$scope","myPage","interface","conference","$modal","theCart",function(a,b,c,d,e,f){a.con=d,a.orig=angular.copy(a.con.options);var g="conference"==a.con.item.template?"Register":"Options";b.setTitle(g,"for "+a.con.item.name),a.noFields=0===a.con.fields.length,a.noFields||(a.attID=function(){return angular.forEach(a.con.fields,function(a){"Attendees"==a.name&&(attID=a.fieldID)}),a.con.options.attID=attID,attID}(),a.attID&&(a.con.options[attID]=[]),a.total=0,a.computeCost=function(b){var c=0,d=a.con.item.cost.settings;return 0===b?(c=parseFloat(d.initial),a.total=0):b>=parseInt(d.after)&&(c=parseFloat(d.later)),a.total+=c,c},a.clr=function(){a.con.options[a.attID]=[],a.total=0},a.rem=function(b,c){c.preventDefault();var d=a.con.options[a.attID];d.splice(b,1),d.length||(a.total=0)},a.add=function(){a.edit()},a.edit=function(b){var c=a.con.options[a.attID],d=e.open({templateUrl:"partials/modal-contact.tpl.html",controller:"ContactModalCtrl",resolve:{contact:function(){return angular.copy(b)},prep:["interface",function(a){return a.user("prepAtten")}],opt:function(){return angular.copy(c)}}});d.result.then(function(d){c||(c=a.con.options[a.attID]=[]);var e=c.indexOf(b);-1===e?c.push(d):c[e]=d})},a.equal=function(a,b){return angular.equals(a,b)},a.reset=function(){a.con.options=angular.copy(a.orig)},a.save=function(b){return console.log(b),b?alert("Form is not valid\nPlease try again."):a.attID&&0===a.con.options[a.attID].length?alert("Please add at least one Attendee to the conference"):(c.cart("setOption",a.con).then(function(){f.setDirty(),e.open({templateUrl:"registerConfNextActionTPL.html",controller:function(a,b,c){a.cart=function(){c.path("/cart"),b.dismiss("cancel")}}})},function(a){console.log(a),alert("Your save was unsuccessful.\nPlease try again or contact UpstreamAcademy for assistance.")}),void 0)})}]).controller("ContactModalCtrl",["$scope","$modalInstance","contact","prep","interface","$modal","opt","$filter",function(a,b,c,d,e,f,g,h){var i={addressID:null,addr2:null},j=c&&c.addr.addressID!=d.add.addressID?c.addr:i;a.contact=c||{addr:i},a.firmEmploy=h("filter")(d.emp,function(a){var b=!1;return angular.forEach(g,function(c){b||c.contactID!=a.contactID||(b=!0)}),!b}),a.addNew=void 0!==c||0===a.firmEmploy.length,a.canChange=void 0===a.contact.contactID&&0!==a.firmEmploy.length;var k=c?c.addr.addressID:-2;a.sameAddr=a.contact.addr.addressID==d.add.addressID,a.$watch("sameAddr",function(b){b?(k!=d.add.addressID&&(j=a.contact.addr),a.contact.addr=d.add):a.contact.addr=j}),a.toggle=function(){a.addNew=!a.addNew},a.cancel=function(){b.dismiss("cancel")},a.edit=function(b){a.contact=b,a.addNew=!0,k=b.addr.addressID,a.sameAddr=k==d.add.addressID,j=a.sameAddr?i:b.addr},a.choose=function(a,c){c.preventDefault(),b.close(a)},a.ok=function(c){if(c)return alert("Form is not valid\nPlease try again.");if(null===a.contact.addr.addressID)return alert("Please assign an address");var d=void 0===a.contact.contactID?"add":"edit";e.user(d+"Contact",a.contact).then(function(c){a.contact.contactID=JSON.parse(c),b.close(a.contact)},function(a){alert("There was an unknown error adding this user\nPlease try again or contact Upstream Academy for help."),console.log(a)})},a.setAddr=function(){var b=f.open({templateUrl:"partials/modal-address.tpl.html",controller:"ModalAddressCtrl",resolve:{address:function(){return angular.copy(a.contact.addr)}}});b.result.then(function(b){a.contact.addr=b})}}]).controller("CartCtrl",["$scope","myPage","$modal","interface","$location","theCart","discounts","$timeout",function(a,b,c,d,e,f,g,h){b.setTitle("Shopping Cart","Checkout"),a.theCart=f,a.discounts=g,a.discountMsg=!1,a.submitMsg=!1,f.registerObserver(function(){d.cart("getDiscount").then(function(b){a.discounts=b})});var i={},j=function(b,c,d){a[b]=c,h.cancel(i[b]),i[b]=h(function(){a[b]=!1},1e3*d)};a.total=function(){return a.theCart.total()-a.discountTotal()},a.discountTotal=function(){var b=0;return angular.forEach(a.discounts,function(a){b+=parseFloat(a.amount)}),b},a.addDiscount=function(b){var c=!1;angular.forEach(a.discounts,function(a){a.code==b&&(c=!0)}),c?j("discountMsg",{pre:"Duplicate Code!",msg:"Are you trying to cheat us?",type:"error"},10):d.cart("addDiscount",{code:b}).then(function(b){j("discountMsg",b,10),"success"==b.type&&a.discounts.push(b.obj)})},a.remDiscount=function(b){d.cart("remDiscount",b).then(function(b){a.discounts=b})},a.saveCart=function(b){var c=!1;return angular.forEach(f.get(),function(a){a.hasOptions&&!a.cost.set&&(c=!0)}),c?j("submitMsg",{pre:"Options Needed",msg:'Some of the items in your cart require you to fill out a form. Please click the orange "Set" buttons to assign these options.',type:"error"},20):(angular.forEach(f.get(),function(a){a.warn&&(c=!0)}),c?j("submitMsg",{pre:"Previous Purchase",msg:"An item in your cart has already been purchased (shown in red).  Please remove it before continueing to checkout.",type:"error"},20):(j("submitMsg",{pre:"Checkout Complete",msg:"You will be redirected to either a) PayPal processing to handle your online payment or b) our recipt page with payment instructions",type:"success"},20),d.cart("save",{cost:a.total(),medium:b}).then(function(){var c="/recipt",d={list:f.get(),disTotal:a.discountTotal(),total:a.total(),medium:b};if(localStorage.setItem("UA-recipt",JSON.stringify(d)),"online"==b){var g="https://payflowlink.paypal.com?";g+="LOGIN=UpstreamAcademy&",g+="PARTNER=PayPal&",g+="TYPE=S&",g+="SHOWCONFIRM=FALSE&",g+="AMOUNT="+d.total+"&",g+="DESCRIPTION=Upstream Academy Purchase&",g+="MODE=TEST&",document.location=g}else e.path(c);f.setDirty()}),void 0))}}]).controller("ReciptCtrl",["$scope","myPage",function(a,b){b.setTitle("Recipt","from last purchase"),a.recipt=JSON.parse(localStorage.getItem("UA-recipt"))}]).controller("HeadCtrl",["$scope","myPage","breadcrumbs","theCart","security",function(a,b,c,d,e){a.myPage=b,a.breadcrumbs=c,a.theCart=d,a.security=e}]).controller("ListPurchasesCtrl",["$scope","myPage","items","$modal",function(a,b,c,d){b.setTitle("Previous Purchases"),a.items=c,angular.forEach(a.items,function(a){a.stamp&&(a.stamp=new Date(a.stamp))}),a.showAttendees=function(a){d.open({templateUrl:"partials/modal-list-attendees.tpl.html",controller:"ModalListAttendeesCtrl",resolve:{item:function(){return a}}})}}]).controller("ModalListAttendeesCtrl",["$scope","$modalInstance","item",function(a,b,c){a.item=c,a.ok=function(){b.close("all good")},a.cancel=function(){b.dismiss("cancel")}}]).controller("CustPayFormCtrl",["$scope","myPage","theCart","$location","$timeout",function(a,b,c,d,e){b.setTitle("Custom Payment Form"),a.success=a.error=!1;var f=0,g={itemID:-1,productID:-1,name:"Custom Payment",template:"custom",img:null};a.item=angular.copy(g),a.add=function(){var b=c.add(a.item);b.then(function(b){b?(a.success=!0,a.error=!1,a.item=angular.copy(g)):(a.error=!0,a.success=!1),e.cancel(f),f=e(function(){a.success=a.error=!1},5e3)})}}]).controller("RegisterFormCtrl",["$scope","myPage","$modal","interface","security","firms",function(a,b,c,d,e,f){b.setTitle("Registration Form"),a.firms=f,a.clearFirm=function(){a.user.firm=void 0,a.user.firmModified=!1},a.user={preName:"",firm:"",firmModified:!1},a.modifyFirm=function(){a.user.firmModified=!0},a.req={pass:!1,len:!1,spe:!1,num:!1,alp:!1},a.$watch("user.password",function(b){b=b||"",a.req.alp=!!b.match(/[a-z]/),a.req.upa=!!b.match(/[A-Z]/),a.req.num=!!b.match(/[0-9]/),a.req.len=!!b.match(/.{6,}/),a.req.spe=!!b.match(/[^a-zA-Z0-9]/),a.req.pass=a.req.alp&&a.req.upa&&a.req.num&&a.req.spe&&a.req.len}),a.register=function(b){return b?alert("Form is not valid\nPlease try again."):a.req.pass?a.passVerify!==a.user.password?alert("Passwords do not match\nPlease try again."):void 0===a.user.firm.addr.addressID?alert("Please assign a firm address"):void 0===a.user.addr.addressID?alert("Please assign a user address"):(d.user("addUser",a.user).then(function(){alert("Your account has successfully been created"),e.requestCurrentUser(),window.history.back()},function(a){"dup"==a?alert("This email already has an account\nPlease click the login button and attempt a password reset."):alert("There was an unknown error creating your account\nPlease try again or contact Upstream Academy for help."),console.log(a)}),void 0):alert("Choose a password that passes all the parameters\nPlease try again.")},a.same=!1;var g=!0,h=null;a.$watch("same",function(b){return g?(g=!1,void 0):(b?(h=a.user.addr,a.user.addr=a.user.firm.addr):a.user.addr=h,void 0)}),a.setAddr=function(b){var d="firm"==b?(a.user.firm||{}).addr:a.user.addr,e=c.open({templateUrl:"partials/modal-address.tpl.html",controller:"ModalAddressCtrl",resolve:{address:function(){return angular.copy(d)}}});e.result.then(function(c){"firm"==b?(a.user.firm="string"==typeof a.user.firm?{name:""}:a.user.firm,a.user.firm.addr=c,a.same&&(a.user.addr=c)):a.user.addr=c})}}]).controller("UserFormCtrl",["$scope","myPage","$modal","interface","security","user","firms",function(a,b,c,d,e,f,g){b.setTitle("Account Settings","for "+f.legalName),a.origUser=angular.copy(f),a.firms=g;var h=!0,i={addressID:void 0};a.$watch("same",function(b){return h?(h=!1,void 0):(b?(i=a.user.addr,a.user.addr=a.user.firm.addr):a.user.addr=i,void 0)}),a.$watch("user.firm.addr",function(b){a.same&&(a.user.addr=b)}),a.req={pass:!1,len:!1,spe:!1,num:!1,alp:!1},a.$watch("user.password",function(b){b=b||"",a.req.alp=!!b.match(/[a-z]/),a.req.upa=!!b.match(/[A-Z]/),a.req.num=!!b.match(/[0-9]/),a.req.len=!!b.match(/.{6,}/),a.req.spe=!!b.match(/[^a-zA-Z0-9]/),a.req.pass=a.req.alp&&a.req.upa&&a.req.num&&a.req.spe&&a.req.len}),a.reset=function(){a.user=angular.copy(a.origUser),a.same=a.user.addr.addressID==a.user.firm.addr.addressID,a.enableFirm=!1,a.passVerify=""},a.reset(),a.store=function(b){return b?alert("Form is not valid\nPlease try again."):a.user.oldPass&&!a.req.pass?alert("Choose a password that passes all the parameters\nPlease try again."):a.user.oldPass&&a.passVerify!==a.user.password?alert("Passwords do not match\nPlease try again."):void 0===a.user.firm.addr.addressID?alert("Please assign a firm address"):void 0===a.user.addr.addressID?alert("Please assign a user address"):(d.user("updateUser",a.user).then(function(){alert("Your account has successfully updated"),e.requestCurrentUser(),window.location.reload()},function(a){"dup"==a?alert("This email already has an account\nPlease click the login button and attempt a password reset."):"badPass"==a?alert("Your password is incorrect\nPlease try again or attempt to reset you password."):alert("There was an unknown error saving your account\nPlease try again or contact UpstreamAcademy for help."),console.log(a)}),void 0)},a.modifyFirm=function(){a.enableFirm=!0,a.firmNew=""},a.selectFirm=function(){a.user.firm=a.firmNew,a.enableFirm=!1},a.newFirm=function(){a.user.firm={},a.enableFirm=!1},a.check=function(a,b){return angular.equals(a,b)},a.setAddr=function(b){var d="firm"==b?(a.user.firm||{}).addr:a.user.addr,e=c.open({templateUrl:"partials/modal-address.tpl.html",controller:"ModalAddressCtrl",resolve:{address:function(){return angular.copy(d)}}});e.result.then(function(c){"firm"==b?(a.user.firm="string"==typeof a.user.firm?{name:""}:a.user.firm,a.user.firm.addr=c,a.same&&(a.user.addr=c)):a.user.addr=c})}}]).controller("ModalAddressCtrl",["$scope","$modalInstance","address","interface",function(a,b,c,d){a.address=c||{addressID:null,addr2:null},a.ok=function(){var c=null===a.address.addressID?"add":"edit";d.user(c+"Address",a.address).then(function(c){console.log(c),a.address.addressID=JSON.parse(c),b.close(a.address)},function(a){console.log(a),console.log("There has been an error adding you address\nPlease try again or contact Upstream Academy for further assistance")})},a.cancel=function(){b.dismiss()}}]),angular.module("myApp.directives",[]),angular.module("myApp.filters",[]).filter("pagination",function(){return function(a,b,c){var d=(b-1)*c;return a.slice(d,d+c)}}).filter("truncate",function(){return function(a,b,c){return isNaN(b)&&(b=10),void 0===c&&(c="..."),a.length<=b||a.length-c.length<=b?a:String(a).substring(0,b-c.length)+c}}).filter("replace",function(){return function(a,b){return angular.isObject(b)?(angular.forEach(b,function(b,c){var d=new RegExp(c,"g");a=a.replace(d,b)}),a):a}}),angular.module("myApp.routers",[]),angular.module("security.authorization",["security.service"]).provider("securityAuthorization",{requireAdminUser:["securityAuthorization",function(a){return a.requireAdminUser()}],requireAuthenticatedUser:["securityAuthorization",function(a){return a.requireAuthenticatedUser()}],$get:["security","securityRetryQueue",function(a,b){var c={requireAuthenticatedUser:function(){var d=a.requestCurrentUser().then(function(d){return a.isAuthenticated()?d:b.pushRetryFn("unauthenticated-client",c.requireAuthenticatedUser)});return d},requireAdminUser:function(){var d=a.requestCurrentUser().then(function(d){return a.isAdmin()?d:b.pushRetryFn("unauthorized-client",c.requireAdminUser)});return d}};return c}]}),angular.module("security",["security.service","security.interceptor","security.login","security.authorization"]),angular.module("security.interceptor",["security.retryQueue"]).factory("securityInterceptor",["$injector","securityRetryQueue",function(a,b){return function(c){return c.then(null,function(d){return 401===d.status&&(c=b.pushRetryFn("unauthorized-server",function(){return a.get("$http")(d.config)})),c})}}]).config(["$httpProvider",function(a){a.responseInterceptors.push("securityInterceptor")}]),angular.module("security.login",["security.login.form","security.login.toolbar"]),angular.module("security.login.form",[]).controller("LoginFormController",["$scope","security",function(a,b){a.user={},a.authError=null,a.authReason=null,b.getLoginReason()&&(a.authReason=b.isAuthenticated()?"You do not have the necessary access permissions.  Do you want to login as someone else?":"You must be logged in to access this part of the application."),a.login=function(){a.authError=null,b.login(a.user.email,a.user.password).then(function(b){b||(a.authError="Login failed.  Please check your credentials and try again.")},function(b){a.authError="There was a problem with authenticating: "+b})},a.clearForm=function(){a.user={}},a.cancelLogin=function(a){console.log(a),console.log("cancelingLogin in security.login.form"),b.cancelLogin(a)},a.register=function(){b.register()}}]),angular.module("security.login.toolbar",[]).directive("loginToolbar",["security",function(a){var b={templateUrl:"js/security/login/toolbar.tpl.html",restrict:"E",replace:!0,scope:!0,link:function(b){b.isAuthenticated=a.isAuthenticated,b.login=a.showLogin,b.logout=a.logout,b.$watch(function(){return a.currentUser},function(a){b.currentUser=a})}};return b}]),angular.module("security.retryQueue",[]).factory("securityRetryQueue",["$q","$log",function(a,b){var c=[],d={onItemAddedCallbacks:[],hasMore:function(){return c.length>0},push:function(a){c.push(a),angular.forEach(d.onItemAddedCallbacks,function(c){try{c(a)}catch(d){b.error("securityRetryQueue.push(retryItem): callback threw an error"+d)}})},pushRetryFn:function(b,c){1===arguments.length&&(c=b,b=void 0);var e=a.defer(),f={reason:b,retry:function(){a.when(c()).then(function(a){e.resolve(a)},function(a){e.reject(a)})},cancel:function(){e.reject()}};return d.push(f),e.promise},retryReason:function(){return d.hasMore()&&c[0].reason},cancelAll:function(){for(;d.hasMore();)c.shift().cancel()},retryAll:function(){for(;d.hasMore();)c.shift().retry()}};return d}]),angular.module("security.service",["security.retryQueue","security.login","ui.bootstrap","myApp.services"]).factory("security",["$http","$q","$location","securityRetryQueue","$modal","interface",function(a,b,c,d,e,f){function g(a){a=a||"/noAuth",c.path(a)}function h(){if(k)throw new Error("Trying to open a dialog that is already open!");k=e.open({templateUrl:"js/security/login/form.tpl.html",controller:"LoginFormController",backdrop:"static"}),k.result.then(j)}function i(a){k&&k.close(a)}function j(a){k=null,a?d.retryAll():(d.cancelAll(),g())}var k=null;d.onItemAddedCallbacks.push(function(){d.hasMore()&&l.showLogin()});var l={getLoginReason:function(){return d.retryReason()},showLogin:function(){h()},login:function(a,b){var c=f.user("login",{email:a,password:b});return c.then(function(a){return l.currentUser=a,l.isAuthenticated()&&i(!0),l.isAuthenticated()})},cancelLogin:function(){i(!1),g()},logout:function(a){f.user("logout").then(function(){l.currentUser=null,g(a)})},register:function(){k.dismiss(),k=null,g("/register")},requestCurrentUser:function(){return l.isAuthenticated()?b.when(l.currentUser):f.user("currentUser").then(function(a){return l.currentUser=a,l.currentUser})},currentUser:null,isAuthenticated:function(){return!!l.currentUser},isAdmin:function(){return!(!l.currentUser||!l.currentUser.admin)},redirect:function(a){g(a)}};return l}]),angular.module("myApp.services",[]).factory("myPage",["$rootScope","$sce",function(a,b){a.pageTitle="Upstream Academy Shop";var c="";return{setTitle:function(b,d){a.pageTitle=b,c=d},getHTML:function(){return b.trustAsHtml(a.pageTitle+" <small>"+c+"</small>")}}}]).factory("breadcrumbs",["$rootScope","$location","interface",function(a,b,c){var d=[],e={};return a.$on("$routeChangeSuccess",function(){function a(a){return e.hasOwnProperty(a.path)?a.name=e[a.path]:c.app("prettyCrumb",a).then(function(b){e[a.path]=b,d[a.index].name=b}),f(a.name)}function f(a){a+="";var b=a.charAt(0).toUpperCase();return b+a.substr(1)}var g,h=b.path().split("/"),i=[],j=function(a){return"/"+h.slice(0,a+1).join("/")};if(""!==h[1])for(h.shift(),g=0;g<h.length;g++){var k={name:f(h[g]),path:j(g),index:g};isNaN(parseInt(k.name))||(k.name=a(k)),i.push(k)}d=i}),{getAll:function(){return d},getFirst:function(){return d[0]||{}},onPage:function(a){return a==(d[d.length-1]||{name:"undefined"}).name}}}]).factory("theCart",["$rootScope","interface","security","$q",function(a,b,c,d){var e=[],f={},g=!0,h=0,i=[];a.$watch(function(){return c.currentUser},l,!0);var j=function(){h=0,angular.forEach(e,function(a){switch(a.cost.value=0,a.hasOptions=!1,a.template){case"conference":if(a.cost.value=parseFloat(a.cost.settings.initial),f.hasOwnProperty(a.itemID)){var b=f[a.itemID].attID,c=(f[a.itemID][b]||[]).length-parseFloat(a.cost.settings.after);c>0&&(a.cost.value+=parseFloat(a.cost.settings.later)*c)}a.hasOptions=!0;break;case"download":a.cost.value=parseFloat(a.cost.settings.cost);break;case"custom":a.cost.value=a.cost.settings.cost;break;default:a.cost={value:0,pretty:"$0.00"}}a.hasOptions&&(a.cost.set=f.hasOwnProperty(a.itemID)),h+=a.cost.value}),angular.forEach(i,function(a){a()})},k=function(a,c){g=!0;var d=b.cart(a,c);return d.then(function(){l()}),d},l=function(){var a=b.cart("get").then(function(a){e=a}),c=b.cart("getOptions").then(function(a){f=a});return d.all([a,c]).then(function(){g=!1,j()})};return{load:function(){var a=null;if(g)a=l();else{var b=d.defer();a=b.promise,b.resolve(e)}return a},len:function(){return e.length||""},add:function(a){return k("add",a)},rem:function(a){return k("rem",a)},get:function(){return e},total:function(){return h},setDirty:function(){g=!0},registerObserver:function(a){-1===i.indexOf(a)&&i.push(a)}}}]).factory("interface",["$http","$q","$rootScope","$timeout",function(a,b,c,d){var e=0,f=-1;c.$watch(function(){return e>0},function(a){c.loading=a,c.loadWarn=!1,d.cancel(f),a&&(f=d(function(){c.loadWarn=!0},1e4))});var g=function(a){try{"string"==typeof a&&(a=JSON.parse(a))}catch(b){}return a},h=function(c,d,f){var h=b.defer();return e++,a.post("/interface.php",f,{params:{c:c,a:d}}).then(function(a){h.resolve(g(a.data)),e--},function(a){h.reject(g(a.data)),e--}),h.promise};return{user:function(a,b){return h("user",a,b)},cart:function(a,b){return h("cart",a,b)},app:function(a,b){return h("app",a,b)}}}]);